-- NAO USAR EM AMBIENTE REAL
USE COMERCIO_OLTP
GO

SELECT * FROM CLIENTE
GO

SELECT * FROM ENDERECO
GO

SELECT * FROM CATEGORIA
GO

SELECT * FROM FORNECEDOR
GO

/*
DERRUBA A TABELA E A RECRIA, NAO TEM COMO DAR ROLLBACK
DDL
TRUNCATE TABLE FORNECEDOR
*/

SELECT * FROM PRODUTO
GO

SELECT * FROM VENDEDOR
GO

SELECT * FROM FORMA_PAGAMENTO
GO

SELECT * FROM NOTA_FISCAL
GO

SELECT COUNT(*) FROM NOTA_FISCAL
GO
/*
-- DETALHANDO A RELAÇÃO GERENTE-VENDEDOR
SELECT NOME, NOME
FROM VENDEDOR
INNER JOIN VENDEDOR
ON ID_VENDEDOR = ID_GERENTE
*/

-- EM TABELAS COM AUTO RELACIONAMENTO CABE UM JOIN COM ELA MESMA
-- BASTANDO PONTERAR
SELECT V.IDVENDEDOR,
		V.NOME AS GERENTE,
		G.NOME AS VENDEDOR,
		G.SEXO,
		G.IDVENDEDOR
FROM VENDEDOR V
INNER JOIN VENDEDOR G
ON V.IDVENDEDOR = G.ID_GERENTE
GO
